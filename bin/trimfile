# last modified 2019-10-24
# Dorai Sitaram

function trimfile1() {
  local f="$1"

  # remove trailing spaces
  # remove all blank lines that don't immediately follow a nonblank line

  sed -i \
    -e 's/\s\+$//' \
    -e '/./,/^$/!d' \
    "$f"

  # could leave blank last line; remove it too

  if sed -ne '$p' "$f" | grep -q '^$'; then
    sed -i -e '$d' "$f"
  fi
}

for f in "$@"; do
  trimfile1 "$f"
done
