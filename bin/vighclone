# last modified 2020-01-17
# created 2019-10-22
# Dorai Sitaram

repo=$1

if echo $repo | grep -vq '^[^/]\+/[^/]\+$'; then
  echo malformed arg $repo; exit
fi

pkgname=${repo#*/}

pkgdir=~/.config/nvim/pack/3rdpartyplugins/start/$pkgname

function updateDoc() {
  if test -d doc; then
    cd doc
    nvim -es -c 'helpt .'
  fi
}

if test ! -d "$pkgdir"; then
  mkdir -p $pkgdir
  cd $pkgdir/..
  git clone https://github.com/$repo
  if test -d $pkgname; then
    cd $pkgname
    updateDoc
  fi
else
  cd $pkgdir
  if git pull | head -1 | grep -vq '^Already'; then
    updateDoc
  fi
fi 
