# last modified 2019-11-07
# created 2019-10-22
# Dorai Sitaram

repo=$1

if echo $repo | grep -vq '^[^/]\+/[^/]\+$'; then
  echo malformed arg $repo; exit
fi

pkgname=${repo#*/}

packdir=~/.config/nvim/pack/3rdpartyplugins/start

pkgsubdir=$packdir/$pkgname

function updateDoc() {
  if test -d doc; then
    cd doc
    nvim -es -c 'helpt .'
  fi
}

if test ! -d "$pkgsubdir"; then
  mkdir -p $pkgsubdir
  cd $packdir
  git clone https://github.com/$repo
  if test -d $pkgname; then
    cd $pkgname
    updateDoc
  fi
else
  cd $pkgsubdir
  if git pull | head -1 | grep -vq '^Already'; then
    updateDoc
  fi
fi 
