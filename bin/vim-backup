# last modified 2020-03-27
# Dorai Sitaram

if test ! "$VIM"; then
  echo Can only be called from Vim
  exit
fi

BDIR=$HOME/.anticlock

if test ! -d $BDIR; then
  mkdir -p $BDIR
  (cd $BDIR; git init)
fi

FILE="$1"

if test -f "$FILE"; then
  cp -p "$FILE" $BDIR

elif test "$FILE" = TINY-VIM; then
  BEXT=.$FILE
  FILE=
  for f in .*$BEXT *$BEXT; do
    if test -f "$f"; then
      g=${f%.*}
      FILE="$FILE $g"
      g=$(basename $g)
      mv $f $BDIR/$g
    fi
  done
fi

cd $BDIR
git add .
git commit -am "$FILE"

