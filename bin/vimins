// Last modified 2018-07-25

cd ~/gh/vim

make distclean

./configure \
  --disable-gui \
  --with-features=tiny

# --without-x

cd src

git checkout -- feature.h

cat >> feature.h <<EOF

#define FEAT_AUTOCHDIR
// #define FEAT_CLIPBOARD
#define FEAT_CMDL_COMPL
// #define FEAT_FIND_ID
// #define FEAT_MOUSE
// #define FEAT_MOUSE_XTERM
// #define FEAT_PATH_EXTRA
// #define FEAT_SEARCHPATH
// #define FEAT_TITLE
// #define FEAT_INS_EXPAND
// #define FEAT_X11
// #define FEAT_XCLIPBOARD

// #define FEAT_CMDL_INFO
// #define FEAT_TEXTOBJ
// #define FEAT_CON_DIALOG
// #define FEAT_CRYPT
// #define FEAT_MBYTE
// #define FEAT_USR_CMDS
// #define FEAT_XFONTSET
// #define USE_ICONV
// #define VIM_BACKTICK

#undef FEAT_TAG_BINS

EOF

# To get +cmdline_compl without +syntax

sed -i -e 's/reset_expand_highlight()/\/* \0 *\//' ex_getln.c

# 'autochdir'

sed -i -e 's/defined(FEAT_NETBEANS_INTG)/\0 || defined(FEAT_AUTOCHDIR) /' misc2.c

cd ..

make

sudo make install

cd src

#strip vim
#
#sudo cp -p vim /usr/bin
#sudo cp -p vim /usr/local/bin

git checkout -- misc2.c
git checkout -- ex_getln.c
git checkout -- feature.h
