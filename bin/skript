# last modified 2018-08-26
# Dorai Sitaram

if test ! -z $SCRIPT_ALREADY_RUNNING; then
  echo script already running; exit
fi

if test $# -ne 0; then
  f=$1
  rm -f $f
else
  f=typescript
  while true; do
    if test ! -f $f; then
      break
    else
      n=$(expr $n + 1)
    fi
    f=typescript$n
  done
fi

export SCRIPT_ALREADY_RUNNING=1

script $f

export SCRIPT_ALREADY_RUNNING=

sed -i -e 's/\r$//' $f
