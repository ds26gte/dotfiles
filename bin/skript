# last modified 2019-10-17
# Dorai Sitaram

if test "$SCRIPT_ALREADY_RUNNING"; then
  echo script already running; exit
fi

if test $# -ne 0; then
  f=$1
  rm -f $f
else
  f=typescript
  while true; do
    if test ! -f $f; then break; fi
    let n="n + 1"
    f=typescript$n
  done
fi

export SCRIPT_ALREADY_RUNNING=1

script $f

export SCRIPT_ALREADY_RUNNING=

sed -i -e 's/\r$//' $f
